# Copy this action to which ever repo you want to deploy and set secrets.lascade.com
# to send over the CENTRAL_DISPATCH_TOKEN. I started of thinking about reusable workflows
# but turns out that is an overkill when you only have a single step.

name: Request Central Vercel Deployment

on:
  workflow_dispatch:
#  push: Uncomment this

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Dispatch to central repo
        uses: peter-evans/repository-dispatch@v3
        with:
          token: ${{ secrets.CENTRAL_DISPATCH_TOKEN }}
          repository: Lascade-Co/actions
          event-type: vercel-commit
          client-payload: >-
            {"repo":${{ toJSON(github.repository) }}, "branch":${{ toJSON(github.head_ref) }} }
